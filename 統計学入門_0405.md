---
title : 条件付確率と独立性
category : Statistics
author : Makoto Yaguchi
---

# 条件付確率と独立性
> 事象 $A$ と $B$ が独立であるとき
> 事象 $B$ が起きたという条件の下で事象 $A$ が起きる確率を表す


[TOC]

## 条件付確率

条件付確率は、ある事象が別の事象が発生した条件の下でどれだけ確率が変化するかを示す指標で、具体的には、$P(A∣B)P(A∣B)$ は事象 $B$ が起きた条件下で事象 $A$ が起きる確率を示します。

条件付確率の定義は以下のようにあらわされます
$$ P(A∣B)=\frac{P(A∩B)}{P(B)}​ $$

以下のように条件付確率の定義を積の形に変形したものを乗法定理と呼びます
$$ P(A∩B) = P(B)P(A∣B)​ $$

乗法定理はAとBを入れ替えて書き換えることができます
$$ P(A∩B) = P(A)P(B|A)​ $$

例えば、サイコロを挙げて見ると、$A$ を「偶数の出目」とし、$B$ を「4以上の出目」とした場合、$P(A∣B)$ はどうなるでしょうか？

サイコロの場合、4が偶数でかつ4以上となる $P(A∩B)$ は4と6の2通りです。
また、$P(B)$ は4, 5, 6の3通りです。したがって、条件付確率は以下の通りになります。

$$
P(A∣B)=\frac{P(A∩B)}{P(B)} = \frac{2}{6} \cdot \frac{6}{3} = \frac{2}{3}
$$

## 独立性
独立性とは、一つの事象が他に事象に影響を与えない状態を指します。$P(A∣B)=P(A)$ および $P(B∣A)=P(B)$ が成り立つとき、事象 $A$ と $B$は独立とされます。書き方を変えて以下のように書くこともできます。

$$ P(A∣B)=P(A) $$

$$ P(B∣A)=P(B) $$

$$ P(A\cap B) =  P(A) \cdot P(B) $$

三つの事象 $ A, B, C$ の独立性については以下の用に表します。
$$
P(A \cap B \cap C) = P(A) \cdot P(B) \cdot P(C)
$$

再びサイコロを考えましょう。$A$ を「偶数の出目」、$B$ を「奇数の出目」とした場合、$P(A)$ と $P(B)$ はそれぞれ $\frac{1}{2}$​ です。

そして、どちらかが起きてももう片方には影響がないため、事象 $A$ と $B$ は独立であるといえます。


## ベイズの定理

ベイズの定理は、事前情報をもとに事後確率を更新するための手法です。事前確率 $P(A)$、尤度 $P(B∣A)$、および事後確率 $P(A∣B)$ の関係は次のように表されます。

$$
P(A∣B)= \frac{P(B∣A)⋅P(A)}{P(B)}​
$$

医学診断において、ある病気 $A$ の発症確率が1%とします。また、検査 $B$ が病気 $A$ を正しく検出する確率が95%、健康な人が誤って陽性と判定される確率が1%とします。このとき、ある人が検査で陽性と判定された場合、その人が本当に病気 $A$ である確率はどれくらいでしょうか？

ベイズの定理を使って解いてみます。ベイズの定理の式より分母は陽性判定全体の確率となるため、病気の人かつ陽性判定 + 病気でない人かつ陽性判定 の形で分母を表します
$$
P(A∣B) = ​\frac{P(B∣A)⋅P(A)}{P(B∣A)⋅P(A) + P(B∣A^c)⋅P(A^c)}, \quad  A^c: Aの余事象
$$

$$
P(A∣B) = ​\frac{0.01 \cdot 0.95}{0.01 \cdot 0.95 + 0.99 \cdot 0.01} \approx 0.49
$$