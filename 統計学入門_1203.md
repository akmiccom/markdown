---
title : いろいろの $ \chi^2 $ 検定
category : Statistics
author : Makoto Yaguchi
---

- $ \chi^2 $ 分布は母分散について様々検定に使われた
- 広くバラツキについての検定の基準としても近似的に使われる

[TOC]

## 適合度の $ \chi^2 $ 検定

- 仮定された理論上の確率分布に対して、標本から求められた度数が適合するかどうかを検証する

- 適合度の検定とは
    - $f_i \fallingdotseq np_i $ であるかどうかを以下の表より得る $\chi^2$ 統計量より判断する
    - 理論確率がこの通りで有れば $\chi^2$ は比較的小さい値をとる

| 属性$A$のカテゴリー | $A_1$  | $A_2$  | $\cdots$ | $A_k$  | 計  |
| ------------------- | ------ | ------ | -------- | ------ | --- |
| 観測度数            | $f_1$  | $f_2$  | $\cdots$ | $f_k$  | $n$ |
| 理論確率            | $p_1$  | $p_2$  | $\cdots$ | $p_k$  | $1$ |
| 理論度数            | $np_1$ | $np_2$ | $\cdots$ | $np_k$ | $n$ |

$$ \chi^2 = \sum_{i=1}^{k} \frac{(f_i-np_i)^2}{np_i} $$


- 帰無仮説を以下のようにして $\chi^2$ 分布表からパーセント点を読む
- 観測度数は理論確率分布に適しているという仮説は $\alpha$ で棄却される
$$ H_0 : P(A_1)=P_1, \cdots P(A_k)=P_k $$

$$  \chi^2 \gt \chi^2_{\alpha}(k-1) $$

## 分割表と独立性の $ \chi^2 $ 検定

- 独立性の $ \chi^2 $ 検定
    - 二つの異なる属性 $ A, B$ を同時に測定すると分割表が作成できる
    - この分割表において属性が独立しているかどうかを検定すること

- 独立性の $ \chi^2 $ 検定の基準
    - 自由度は $(r-1)(s-1)$ として $\chi^2$ 分布表からパーセント点を読む
$$ \chi^2 = \sum_i \sum_j \frac{(f_ij - f_{i\cdot} f_{\cdot j} / n)^2}{f_{i\cdot} f_{\cdot j} / n} = \sum_i \sum_j \frac{(f_ij - f_{i\cdot} f_{\cdot j})^2}{f_{i\cdot} f_{\cdot j}} $$

- 分割表より理論度数(期待度数)を求める
    - 分割表
    - 理論度数表
        - 心筋梗塞ありなしの比により数値を求め、独立である場合の仮説を立てる
        - $ 7.5 = 10 \times 15 / 20 $ 
        - $ 2.5 = 10 \times 5 / 20 $ 

|            | 心筋梗塞あり | 心筋梗塞なし | 合計 |
| ---------- | ------------ | ------------ | ---- |
| 喫煙歴あり | 9            | 6            | 15   |
| 喫煙歴なし | 1            | 4            | 5    |
| 合計       | 10           | 10           | 20   |

|            | 心筋梗塞あり | 心筋梗塞なし | 合計 |
| ---------- | ------------ | ------------ | ---- |
| 喫煙歴あり | 7.5          | 7.5          | 15   |
| 喫煙歴なし | 2.5          | 2.5          | 5    |
| 合計       | 10           | 10           | 20   |

- 計算結果は以下となり棄却域 $\alpha = 0.05$ とすると計算した統計量のほうが小さいので棄却され、独立とは言えない(関連性がある)ということになる

$$ \chi^2 = \frac{(9-7.5)^2}{7.5} + \frac{(6-7.5)^2}{7.5} + \frac{(1-2.5)^2}{2.5} + \frac{(4-2.5)^2}{2.5} = 2.40 $$

$$ \chi^2_{\alpha=0.05}(1) = 3.84 $$